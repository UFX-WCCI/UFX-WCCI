@*@Using UFX_WCCI.Models*@
@model UFX_WCCI.Models.ApplicationUser



<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title></title>
</head>
<body>
    <div class="col-md-6">
        <br />
        <br />
        <br />
        @Model.UserName
        <br />
        <div>
            <script>
                var isFollowing = false;
                @foreach(var follow in Model.Following){
                    if (Model == follow)
                    {
                        @:isFollowing = true;
                                    };
                };
                if (isFollowing){
                    var following = document.getElementById("follow");
                    following.setAttribute('class','hide');
                }
                else{
                    var following = document.getElementById("unfollow");
                    following.setAttribute('class','hide');
                };
            </script>

            <div id="follow">
                @Html.ActionLink("Follow", "AddFollowing", "Postings", new { id = Model.Id }, null)
            </div>
            <div id="unfollow">
                @Html.ActionLink("UnFollow", "DeleteFollowing", "Postings", new { id = Model.Id }, null)
            </div>


        </div>
        <br />
        <img src="~/AvatarFile?id=@Model.Id" width="200" height="200" />
        <br />
        @Model.Bio
        <br />
        @if (Model.Email != null)
        {
            <span> @Model.Email </span>
        }
        <br />
        <div class="hide">
            @Model.Latitude
            @Model.Longitude
        </div>

        // display map 
        <div id="map_canvas" style="width:425px; height:550px;"></div>
    </div>

    // where the posts would go
    <div class="col-md-6">
        <table class="table">
            <tr>
                <th>
                    Description
                </th>
                <th>
                    Price
                </th>
                <th>
                    Quantity
                </th>
                <th>
                    Photo
                </th>
                <th>
                    Posting Time
                </th>
            </tr>


            foreach (var item in @Model)
            {
                <tr>

                    <td>
                        @Html.ActionLink(item.AppUser.UserName, "UserProfile", "Postings", new { id = item.AppUser.Id }, null)
                    </td>

                    <td>
                        @Html.DisplayFor(modelItem => item.Price)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Desc)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Quantity)
                    </td>
                    <td>
                        @*Code from Olay tutorial to display image. Needs its own contoller to fully function*@
                        <img src="~/PostFile?id=@item.PostingID" width="75" height="75" />
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PostingTime)
                    </td>
                    <td>

                        @if (item.AppUser == ViewBag.CurrentUser)
                        {
                            <span> @Html.ActionLink("Edit", "Edit", new { id = item.PostingID }) |</span>

                            <span>@Html.ActionLink("Delete", "Delete", new { id = item.PostingID })</span>
                        }
                    </td>
                </tr>
            }

        </table>

    </div>

    <script type="text/javascript" src="https://maps.google.com/maps/api/js?key=AIzaSyBsT1NB4_Y4FwHcrXCKqRXell4s6rInvUg"></script>
    <script type="text/javascript">


        var map;
        var markers = [];
       

        initialize();

        function initialize() {

            var myOptions = {
                zoom: 10,
                center: new google.maps.LatLng(@Model.Latitude,@Model.Longitude),
                mapTypeId: google.maps.MapTypeId.ROADMAP
            }
            map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

            addMarker(new google.maps.LatLng(@Model.Latitude, @Model.Longitude), "User");
        }

        function addMarker(latlng, myTitle) {
            markers.push(new google.maps.Marker({
                position: latlng,
                map: map,
                title: myTitle,
                icon: "https://maps.google.com/mapfiles/marker" + String.fromCharCode(markers.length + 65) + ".png"
            }));
        }

    </script>
</body>
</html>
